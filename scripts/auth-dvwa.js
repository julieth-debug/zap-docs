function authenticate(e,t,n){var r=t.get("Login URL"),a=t.get("CSRF Field"),o=extractInputFieldValue(getPageContent(e,r),a),s=t.get("POST Data");s=s.replace("{%username%}",encodeURIComponent(n.getParam("Username"))),s=s.replace("{%password%}",encodeURIComponent(n.getParam("Password"))),s=s.replace("{%"+a+"%}",encodeURIComponent(o));var u=sendAndReceive(e,r,s);return u}function getRequiredParamsNames(){return["Login URL","CSRF Field","POST Data"]}function getOptionalParamsNames(){return[]}function getCredentialsParamsNames(){return["Username","Password"]}function getPageContent(e,t){var n=sendAndReceive(e,t);return n.getResponseBody().toString()}function sendAndReceive(e,t,n){var r=e.prepareMessage(),a="GET";n&&(a="POST",r.setRequestBody(n));var o=new org.apache.commons.httpclient.URI(t,!0),s=new org.parosproxy.paros.network.HttpRequestHeader(a,o,"HTTP/1.0");return r.setRequestHeader(s),e.sendAndReceive(r),r}function extractInputFieldValue(e,t){for(var n=Java.type("net.htmlparser.jericho.Source"),r=new n(e),a=r.getAllElements("input").iterator();a.hasNext();){var o=a.next();if(o.getAttributeValue("name")==t)return o.getAttributeValue("value")}return""}